version: '1'
name: debug2
vars:
tasks:
  user_sql:
    executor: sql
    clients: [client1]
    wait: "input"
    payload: |
      {
        "driver": "mysql",
        "host": "127.0.0.1",
        "port": "3306",
        "user": "nghia",
        "password": "root",
        "dbname": "workflow"
      }
  user_file:
    executor: file
    clients: [client1]
    payload: |
      {
        "method": "read",
        "path": "/text.txt"
      }
brokers:
  brok:
    clients: [client1]
    listens: [user_sql_task, user_file_task]
    flows: |
      {{get .user_file_task ("result") | .result | get ("output") | .output}}
        {{hello | script | .sql }}
        {{define .mp map | put ("sql") .output | put ("sql") .sql  | .result}}
          {{send .result .user_sql_task}}
        {{end}}
      {{end}}